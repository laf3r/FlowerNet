---
license: gpl-2.0 
---
[![Hugging Face](https://img.shields.io/badge/Hugging%20Face-%F0%9F%A4%97-%2300BFFF)](https://huggingface.co/Innokentiy)
# FlowerNet
## Нейросеть для многоклассовой классификации цветов.
![одуванчик](https://github.com/laf3r/FlowerNet/assets/101829424/fd23e821-28a3-40e4-a4b9-cfd50947d458)

## Введение
Цель данной работы заключается в разработке нейронной сети для многоклассовой классификации, обладающей **высокой устойчивостью** к переобучению.

## Набор данных (Dataset)
Для решения задачи многоклассовой классификации цветов, я использовал набор данных tf_flowers из tensorflow. 
Набор имеет 5 классов цветов: 'Одуванчик', 'Ромашка', 'Тюльпаны', 'Подсолнухи' и 'Розы'. Поэтому на конечном слое Dense 5 нейронов. Теперь про выборки. Я разбил набор данных на три выборки: от 0 до 80% - тренировочная, от 80% до 90% - проверочная(валидационная) и от 90% до 100% - тестовая. 

## Архитектура сети
К качестве архитектуры я использовал xception. Схема архитектуры получилась большая, поэтому я решил не вставлять ей сюда, а загрузить в файлы проекта. 
Нейронная сеть предназначена для работы на тензорных процессорах (TPU), это позволяет повысить количество эпох и мощность.

## Оптимизатор и функция потерь
![график](https://github.com/laf3r/FlowerNet/assets/101829424/558f0826-cba1-4611-967c-6f1235e00e15)

Моей целью было создать крепкую нейронную сеть, которая обладала бы высокой устойчивостью к переобучению.
И тут начинается настройка.
Если использовать оптимизатор Adam, который я использовал ранее, то точность будет 90%, но при этом будет переобучение. Поэтому я решил зайти с другого бока, и использовать оптимизатор Adagrad(Adaptive Gradient) - его точность на 10 эпохе была 40%, но чем больше эпох, тем лучше его точность, и при этом точность проверочной выборки будет всегда выше чем тренировочной, и переобучения не будет. В качестве функции потерь я использую SparseCategoricalCrossentropy, так как именно её нужно использовать на TPU моделях. Так как модель моя модель использует тензорный процессор и быстро проходит эпохи, я решил увеличить количество эпох до тысячи. Adagrad начал с 40%, постепенно его точность увеличивалась, и в конечном итоге я получил точность 89.65% на проверочных данных и 0.87% на тестовых. При этом на графике можно увидеть, что модель не подвергается переобучению. 


## Результат
![результат](https://github.com/laf3r/FlowerNet/assets/101829424/f0fb6e64-9f66-425a-a111-d5c9a3a89bf5)


Задача выполнена. Я создал модель которая имеет устойчивую защиту от переобучения и хорошую точность 87%. 
Модель доступна для скачивания на huggingface: https://huggingface.co/Innokentiy/FlowerNet

>Программа предоставляется в виде открытого исходного кода.


